---
title: "GEMMI and Servalcat restrain REFMAC5"
date: 2023-05-04T19:03:26+01:00
draft: false
tags: [servalcat]
---

https://doi.org/10.1107/S2059798323002413

Servalcat論文第二弾出ました．去年のCCP4 study weekendのproceedingsの一部です．同じvirtual issueにCCP4の新しい論文も載ります．

REFMAC5は20年以上前に書かれたプログラムで，特にその中のMAKECIFと呼ばれる機能がモデル(pdb/mmcif)を読んでrestraintを作るんですが，歴史的経緯からロジックが必要以上に複雑になっており，メンテナンスがしづらくなっていました．
そこでいま開発が活発に進んでいるGEMMIのライブラリを利用して置き換えようというのが今回の内容です．
これによって，例えば今までREFMAC5が扱えなかったmicroheterogeneityなどが扱えるようになりました．
また，REFMAC5は最初にmonomer library (今や35298個ものmonomerが収録されています)の中身を全部読んでから処理する仕組みだったりして精密化がスタートするまで時間がかかっていたんですが，この部分が一瞬で終わるようになりました．精密化計算の方がずっと時間はかかるので，全体の中ではわずかな改善ですが．

詳細は論文にありますが，この機能はServalcatに実装された"refmacat"コマンドを通じて使えるようになっています．
先日出たCCP4 8.0.011にこっそりとServalcat 0.4.0が入ったので，CCP4をアップデートすれば使えるようになります．
今まで `refmac5 xyzin ...` のようにして使っていたのを， `refmacat xyzin ...`のようにコマンド名だけ置き換えればそのまま動くというわけです．

モデルファイルの読み込みはGEMMIライブラリを通じて行われるので，GEMMIがサポートしている形式なら何でも読めることになります．
Gzipのまま読めるのは地味に嬉しいポイントです．
出力モデルもGEMMIを使って再出力されるので，[hybrid-36](https://cci.lbl.gov/hybrid_36/)によりPDB形式でもほとんどの巨大分子が扱えます．
結局各種プログラムのmmCIFへの対応状況が悪く，hybrid-36 PDBの方が勝手が良いというのが現状かと思われます．

未対応の問題として，4文字以上の残基名はREFMAC5ではまだ使えません．
そう遠くない未来に[3文字IDが枯渇する](https://www.wwpdb.org/news/news?year=2023#63ff72ccc031758bf1c30ff7)ので，各種プログラムは対応を迫られています．
それまでにREFMAC5が直るか，あるいはServalcatがREFMAC5をすっかり置き換えるようになっているかもしれません(？)
またこうなるとPDB形式は本当に使えなくなるので，ついにmmCIFへの移行も必要です．
とはいえ手元で何らかの3文字IDで作り直してしまえば動かせるので，結局みんな何とかしてPDB形式を使い続けるかもしれませんが．